<view class="container">
    <!-- 头部：日期选择和历史按钮 -->
    <view class="header">
        <picker mode="date" value="{{currentDate}}" start="2020-01-01" end="2030-12-31" bindchange="onDateChange">
            <!-- 可见的点击区域（放在 picker 内部） -->
            <view class="date-picker">
                <text class="date-text">{{currentDate}}</text>
            </view>
        </picker>
        <button bindtap="goToHistory" class="history-btn">历史记录</button>
    </view>

    <!-- 记账表单卡片 -->
    <view class="account-form-card">
        <!-- 金额输入 -->
        <view class="form-item amount-item">
            <text class="label">金额</text>
            <text class="amount-symbol">¥</text>
            <input type="number" placeholder="0.00" bindinput="onAmountInput" value="{{amount}}" class="amount-input"
                placeholder-style="color:#ccc" />
        </view>

        <!-- 消费类型选择 -->
        <view class="form-item">
            <text class="label">消费类型</text>
            <view class="type-selector" bindtap="openTypeDialog">
                <text class="type-text">{{selectedType.name}}</text>
            </view>
        </view>

        <!-- 备注输入 -->
        <!-- <view class="form-item">
            <text class="label">备注</text>
            <input type="text" placeholder="例如：早餐、交通" bindinput="onRemarkInput" value="{{remark}}" class="remark-input"
                placeholder-style="color:#ccc" />
        </view> -->

        <!-- 收支切换 -->
        <!-- <view class="form-item type-toggle">
            <button class="toggle-btn {{type === 'expense' ? 'active-expense' : ''}}" bindtap="setType"
                data-type="expense">
                支出
            </button>
            <button class="toggle-btn {{type === 'income' ? 'active-income' : ''}}" bindtap="setType"
                data-type="income">
                收入
            </button>
        </view> -->

        <button bindtap="addRecord" class="submit-btn">保存记录</button>
    </view>

    <!-- 今日记录列表 -->
    <view class="today-records">
        <view class="section-title">
            <text>今日记录</text>
            <view class="summary">
                <text class="expense">支出：¥{{totalExpense}}</text>
                <!-- <text class="income">收入：¥{{totalIncome}}</text> -->
            </view>
        </view>

        <view class="empty" wx:if="{{todayRecords.length === 0}}">
            <text>暂无记录，开始添加吧~</text>
        </view>

        <view class="record-list">
            <view class="record-item" wx:for="{{todayRecords}}" wx:key="index">
                <view class="record-info">
                    <view class="record-remark">{{item.remark}}</view>
                    <view class="record-time">{{item.time}}</view>
                </view>
                <view class="record-amount" style="color: {{item.type === 'expense' ? '#ff4d4f' : '#07c160'}}">
                    {{item.type === 'expense' ? '-' : '+'}}¥{{item.amount}}
                </view>
                <button class="delete-btn" bindtap="deleteRecord" data-index="{{index}}" size="mini">
                    删除
                </button>
            </view>
        </view>
    </view>

    <!-- 消费类型选择弹窗 -->
    <mp-half-screen-dialog title="选择消费类型" show="{{showTypeDialog}}" bindclose="closeTypeDialog">
        <view slot="desc" class="type-grid">
            <view class="type-grid-item" wx:for="{{typeList}}" wx:key="id" bindtap="selectType" data-item="{{item}}">
                <text class="grid-text">{{item.name}}</text>
            </view>
        </view>
    </mp-half-screen-dialog>
</view>